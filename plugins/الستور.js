import fetch from "node-fetch";

let handler = async (m, { conn, text }) => {
  if (!text) return m.reply(`*â•­â”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâŸ*
*â†â”‡ğŸ”ª Ù‡Ù„ ØªØ¸Ù† Ø£Ù†Ù†ÙŠ Ø£Ù‚Ø±Ø£ Ø§Ù„Ø¹Ù‚ÙˆÙ„ØŸ Ø§ÙƒØªØ¨ Ø´ÙŠØ¦Ù‹Ø§ Ø¨Ø¹Ø¯ Ø§Ù„Ø£Ù…Ø± â†*
*â†â”‡Ù…Ø«Ø§Ù„: .Ø§Ø³ØªÙˆØ± Ø§ÙØ¶Ù„ Ø§Ù†Ù…ÙŠ â†*
*â•°â”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâŸ*`);

  await m.reply(`*â•­â”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâŸ*
*â†â”‡... Ù‡Ø°Ø§ Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ø°ÙŠ ØªØ¶ÙŠØ¹ ÙÙŠÙ‡ØŒ ÙÙ‚Ø· Ù„Ø£Ø³Ø£Ù„ÙƒØŸ Ø§Ù†ØªØ¸Ø± Ù„Ø­Ø¸Ø© â†*
*â•°â”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâŸ*`);

  try {
    let result = await CleanDx(text);
    await m.reply(`*â•­â”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâŸ*
*â†â”‡ğŸ’€ Ø±Ø¯ Ø§Ù„Ø§Ø³ØªÙˆØ± â†*
${result}
*â•°â”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâŸ*`);
  } catch (e) {
    await m.reply(`*â•­â”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâŸ*
*â†â”‡Ù‡Ù„ ØªØ¸Ù† Ø£Ù†Ù†ÙŠ Ø£Ù‡ØªÙ…ØŸ Ø­ØªÙ‰ Ø§Ù„Ù€ AI Ù„Ø§ ÙŠØªÙˆØ§Ù†Ù‰ Ø¹Ù† ØªØ¬Ø§Ù‡Ù„Ùƒ â†*
*â•°â”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâŸ*`);
  }
};

handler.help = ["dx"];
handler.tags = ["ai"];
handler.command = /^(Ø§Ù„Ø³ØªÙˆØ±)$/i;

export default handler;

async function CleanDx(your_qus) {
  let Baseurl = "https://alakreb.vercel.app/api/ai/gpt?q=";
  
  // ØªÙˆØ¬ÙŠÙ‡ Ù„Ù„Ù€ API Ø¨Ø£Ø³Ù„ÙˆØ¨ Ø§Ù„Ø§Ø³ØªÙˆØ± Ù…Ù† "Ù‡Ø§Ø²Ø¨ÙŠÙ† Ù‡ÙˆØªÙŠÙ„"
  let prompt = `ØªØ­Ø¯Ø« ÙƒÙ€ Ø§Ù„Ø§Ø³ØªÙˆØ± Ù…Ù† "Ù‡Ø§Ø²Ø¨ÙŠÙ† Ù‡ÙˆØªÙŠÙ„". Ø§Ø³ØªØ®Ø¯Ù… Ø£Ø³Ù„ÙˆØ¨Ù‡ Ø§Ù„Ø®Ø§Øµ ÙÙŠ Ø§Ù„Ø±Ø¯ØŒ Ù‚Ø³ÙˆØ©ØŒ Ø³Ø®Ø±ÙŠØ©ØŒ ÙˆØ°ÙƒØ§Ø¡ Ù„Ø§Ø°Ø¹. Ø³Ø¤Ø§Ù„ÙŠ Ù‡Ùˆ: ${your_qus}`;

  let response = await fetch(Baseurl + encodeURIComponent(prompt));
  let data = await response.json();
  return data.message;
}